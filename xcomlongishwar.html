<div class="main">

	<!-- VITALS SECTION -->
	<div class="vitals section">

		<div class="section-small flex-center">
			<label>Name:</label>
			<input type="text" name="attr_character_name" />
		</div>

		<div class="section-small flex-center">
			<label>Rank:</label>
			<select name="attr_rank">
			    <option selected value="Rookie">Rookie</option>
			    <option value="Specialist">Specialist</option>
			    <option value="LanceCorporal">Lance Corporal</option>
			    <option value="Corporal">Corporal</option>
			    <option value="Sergeant">Sergeant</option>
			    <option value="TechSergeant">Tech Sergeant</option>
			    <option value="GunnerySergeant">Gunnery Sergeant</option>
			    <option value="MasterSergeant">Master Sergeant</option>
	        </select>
		</div>

		<div class="section-small flex-center">
			<label>Class:</label>
			<select name="attr_class">
			    <option value="Assault">Assault</option>
			    <option value="Grenadier">Grenadier</option>
			    <option value="Gunner">Gunner</option>
			    <option value="Infantry">Infantry</option>
			    <option value="Medic">Medic</option>
			    <option value="Rocketeer">Rocketeer</option>
			    <option selected value="Rookie">Rookie</option>
			    <option value="Scout">Scout</option>
			    <option value="Sharpshooter">Sharpshooter</option>
			</select>
		</div>

		<div class="section-small flex-center">
			<label>Nationality:</label>
			<input type="text" name="attr_nationality" />
		</div>

		<div class="section-small flex-center">
			<label>Callsign:</label>
			<input type="text" name="attr_callsign" />
		</div>

	</div>

	<!-- COUNTS SECTION -->
	<div class="counts section">

		<div class="section-small flex-center">
			<label>Missions:</label>
			<input type="number" name="attr_missions" value=0 />
		</div>

		<div class="section-small flex-center">
			<label>Kills:</label>
			<input type="number" name="attr_kills" value=0 />
		</div>

		<div class="section-small flex-center">
			<label>XP:</label>
			<input type="number" name="attr_xp" value=0 />
		</div>

		<div class="section-small flex-center">
			<label></label>
		</div>

		<div class="section-small flex-center">
			<label>Hit Points:</label>
			<input type="number" name="attr_hp" />
		</div>

		<div class="section-small flex-center">
			<label>Mobility:</label>
			<input type="number" name="attr_mobility" />
		</div>

	</div>

	<!-- STATS SECTION -->
	<div class="stats section">

		<div class="section-small flex-center">
			<label>Health:</label>
			<input type="number" name="attr_base_health" value=3 />
		</div>

		<div class="section-small flex-center">
			<label>Aim:</label>
			<input type="number" name="attr_base_aim" value=65 />
		</div>

		<div class="section-small flex-center">
			<label>Mobility:</label>
			<input type="number" name="attr_base_mobility" value=6 />
		</div>

		<div class="section-small flex-center">
			<label>Defense:</label>
			<input type="number" name="attr_base_defense" value=0 />
		</div>

		<div class="section-small flex-center">
			<label>Dodge:</label>
			<input type="number" name="attr_base_dodge" value=0 />
		</div>

		<div class="section-small flex-center">
			<label>Will:</label>
			<input type="number" name="attr_base_will" value=40 />
		</div>

	</div>

	<!-- PRIMARY WEAPON SECTION -->
	<div class="priweap section">

		<div class="section-small flex-center">
			<label>Primary Weapon:</label>
			<select name="attr_priweap">
				<option value="ArcRifle">Arc Rifle</option>
			    <option value="AssaultCarbine">Assault Carbine</option>
			    <option selected value="AssaultRifle">Assault Rifle</option>
			    <option value="BattleRifle">Battle Rifle</option>
			    <option value="LMG">LMG</option>
			    <option value="SAW">SAW</option>
			    <option value="Shotgun">Shotgun</option>
			    <option value="SMG">SMG</option>
			    <option value="SniperRifle">Sniper Rifle</option>
			    <option value="MarksmansRifle">Marksmans Rifle</option>
			</select>
		</div>

		<div class="section-half-width flex-center">
			<label>Base Dmg</label>
			<input type="text" name="attr_priweap_dmg" />
		</div>
		<div class="section-half-width flex-center">
			<label>Crit Dmg</label>
			<input type="text" name="attr_priweap_critdmg" />
		</div>

		<div class="section-half-width flex-center">
			<label>Ammo</label>
			<input type="number" name="attr_priweap_ammo" />
		</div>
		<div class="section-half-width flex-center">
			<label>Crit Chance</label>
			<input type="number" name="attr_priweap_critchance" />
		</div>

		<div class="section-half-width flex-center">
			<label>Mobility</label>
			<input type="number" name="attr_priweap_mobility" />
		</div>
		<div class="section-half-width flex-center">
			<label>Aim</label>
			<input type="number" name="attr_priweap_aim" />
		</div>

		<div class="section-small flex-center">
			<label>Effects</label>
			<input type="text" name="attr_priweap_effects" />
		</div>

	</div>

	<!-- SECONDARY WEAPON SECTION -->
	<div class="sec-weap section">

		<div class="section-small flex-center">
			<label>Secondary Weapon:</label>
			<select name="attr_secweap">
			    <option value="CombatKnife">Combat Knife</option>
			    <option value="Holotargeter">Holotargeter</option>
			    <option value="Pistol">Pistol</option>
			    <option value="RocketLauncher">Rocket Launcher</option>
			    <option value="SawedOffShotgun">Sawed Off Shotgun</option>
			    <option value="Sword">Sword</option>
			</select>
		</div>

		<div class="section-half-width flex-center">
			<label>Base Dmg</label>
			<input type="text" name="attr_secweap_dmg" />
		</div>
		<div class="section-half-width flex-center">
			<label>Crit Dmg</label>
			<input type="text" name="attr_secweap_critdmg" />
		</div>

		<div class="section-half-width flex-center">
			<label>Ammo</label>
			<input type="number" name="attr_secweap_ammo" />
		</div>
		<div class="section-half-width flex-center">
			<label>Crit Chance</label>
			<input type="number" name="attr_secweap_critchance" />
		</div>

		<div class="section-half-width flex-center">
			<label>Mobility</label>
			<input type="number" name="attr_secweap_mobility" />
		</div>
		<div class="section-half-width flex-center">
			<label>Aim</label>
			<input type="number" name="attr_secweap_aim" />
		</div>

		<div class="section-small flex-center">
			<label>Effects</label>
			<input type="text" name="attr_secweap_effects" />
		</div>

	</div>

	<!-- ARMOR SECTION -->
	<div class="armor section">

		<div class="section-small flex-center">
			<label>Armor:</label>
			<select name="attr_armor_name">
			    <option value="LeatherJacket">Leather Jacket</option>
			    <option value="TacArmor">Tac Armor</option>
			    <option value="TacVest">Tac Vest</option>
			</select>
		</div>

		<div class="section-half-width flex-center">
			<label>Mobility</label>
			<input type="number" name="attr_armor_mobility" />
		</div>
		<div class="section-half-width flex-center">
			<label>HP</label>
			<input type="number" name="attr_armor_hp" />
		</div>

		<div class="section-half-width flex-center">
			<label>Armor</label>
			<input type="number" name="attr_armor_value" />
		</div>
		<div class="section-half-width flex-center">
			<label>Defense</label>
			<input type="number" name="attr_armor_defense" />
		</div>

		<div class="section-small flex-center">
			<label>Effects</label>
			<input type="text" name="attr_armor_effects" />
		</div>

	</div>

	<!-- UTILITY ITEM 1 SECTION -->
	<div class="utilone section">

		<div class="section-small flex-center">
			<label>Utility Item 1:</label>
			<select name="attr_utilone">
				<option value="AlienTrophy">Alien Trophy</option>
				<option value="APGrenade">AP Grenade</option>
				<option value="BattleScanner">Battle Scanner</option>
				<option value="CeramicPlating">Ceramic Plating</option>
				<option value="DrumMags">Drum Mags</option>
				<option value="Flashbang">Flashbang</option>
				<option value="HEGrenade">HE Grenade</option>
				<option value="HighCapMags">High Cap Mags</option>
				<option value="LaserSight">Laser Sight</option>
				<option value="Medkit">Medkit</option>
				<option value="Rocket">Rocket</option>
				<option value="ShredderRocket">Shredder Rocket</option>
				<option value="SmokeGrenade">Smoke Grenade</option>
			</select>
		</div>

		<div class="section-small flex-center">
			<label>Effects</label>
			<input type="text" name="attr_utilone_effects" />
		</div>

	</div>

	<!-- UTILITY ITEM 2 SECTION -->
	<div class="utiltwo section">

		<div class="section-small flex-center">
			<label>Utility Item 2:</label>
			<select name="attr_utiltwo">
				<option value="AlienTrophy">Alien Trophy</option>
				<option value="APGrenade">AP Grenade</option>
				<option value="BattleScanner">Battle Scanner</option>
				<option value="CeramicPlating">Ceramic Plating</option>
				<option value="DrumMags">Drum Mags</option>
				<option value="Flashbang">Flashbang</option>
				<option value="HEGrenade">HE Grenade</option>
				<option value="HighCapMags">High Cap Mags</option>
				<option value="LaserSight">Laser Sight</option>
				<option value="Medkit">Medkit</option>
				<option value="Rocket">Rocket</option>
				<option value="ShredderRocket">Shredder Rocket</option>
				<option value="SmokeGrenade">Smoke Grenade</option>
			</select>
		</div>

		<div class="section-small flex-center">
			<label>Effects</label>
			<input type="text" name="attr_utiltwo_effects" />
		</div>

	</div>

</div>

<script type="text/worker">

on("change:priweap", function() {
	getAttrs(["priweap", "secweap_mobility", "base_mobility", "armor_mobility"], function(values) {
		console.log("**XCOM** priweap = " + values.priweap);
		switch(values.priweap) {
			case "AssaultRifle":
				setAttrs({
					priweap_dmg: "2+1d3",
					priweap_critdmg: "2",
					priweap_ammo: "3",
					priweap_ammo_max: "3",
					priweap_critchance: "8",
					priweap_mobility: "0",
					priweap_aim: "0",
					priweap_effects: "None",
					mobility: parseInt(values.base_mobility) + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "AssaultCarbine":
				setAttrs({
					priweap_dmg: "1+1d3",
					priweap_critdmg: "2",
					priweap_ammo: "3",
					priweap_ammo_max: "3",
					priweap_critchance: "4",
					priweap_mobility: "1",
					priweap_aim: "8",
					priweap_effects: "None",
					mobility: parseInt(values.base_mobility) + 1 + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "SMG":
				setAttrs({
					priweap_dmg: "1+1d2",
					priweap_critdmg: "2",
					priweap_ammo: "2",
					priweap_ammo_max: "2",
					priweap_critchance: "0",
					priweap_mobility: "2",
					priweap_aim: "0",
					priweap_effects: "None",
					mobility: parseInt(values.base_mobility) + 2 + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "BattleRifle":
				setAttrs({
					priweap_dmg: "3+1d3",
					priweap_critdmg: "3",
					priweap_ammo: "3",
					priweap_ammo_max: "3",
					priweap_critchance: "8",
					priweap_mobility: "-1",
					priweap_aim: "0",
					priweap_effects: "Aim -6 if 2nd action",
					mobility: parseInt(values.base_mobility) -1 + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "Shotgun":
				setAttrs({
					priweap_dmg: "3+1d5",
					priweap_critdmg: "4",
					priweap_ammo: "4",
					priweap_ammo_max: "4",
					priweap_critchance: "16",
					priweap_mobility: "0",
					priweap_aim: "0",
					priweap_effects: "Aim +25; Aim -5 per tile > 1; Target Armor +50%",
					mobility: parseInt(values.base_mobility) + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "SniperRifle":
				setAttrs({
					priweap_dmg: "3+1d3",
					priweap_critdmg: "2",
					priweap_ammo: "5",
					priweap_ammo_max: "5",
					priweap_critchance: "20",
					priweap_mobility: "-1",
					priweap_aim: "0",
					priweap_effects: "Aim -30 v adjacent, +5 per tile > 1 (max 0); 2 AP to fire",
					mobility: parseInt(values.base_mobility) -1 + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "MarksmansRifle":
				setAttrs({
					priweap_dmg: "3+1d3",
					priweap_critdmg: "2",
					priweap_ammo: "5",
					priweap_ammo_max: "5",
					priweap_critchance: "12",
					priweap_mobility: "0",
					priweap_aim: "0",
					priweap_effects: "Aim -30 v adjacent, +5 per tile > 1 (max 0)",
					mobility: parseInt(values.base_mobility) + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "SAW":
				setAttrs({
					priweap_dmg: "3+1d3",
					priweap_critdmg: "2",
					priweap_ammo: "6",
					priweap_ammo_max: "6",
					priweap_critchance: "0",
					priweap_mobility: "-1",
					priweap_aim: "0",
					priweap_effects: "None",
					mobility: parseInt(values.base_mobility) -1 + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "LMG":
				setAttrs({
					priweap_dmg: "3+1d5",
					priweap_critdmg: "4",
					priweap_ammo: "8",
					priweap_ammo_max: "8",
					priweap_critchance: "0",
					priweap_mobility: "-1",
					priweap_aim: "0",
					priweap_effects: "Grants Squadsight ability; 2 AP to fire",
					mobility: parseInt(values.base_mobility) -1 + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "ArcRifle":
				setAttrs({
					priweap_dmg: "0",
					priweap_critdmg: "0",
					priweap_ammo: "0",
					priweap_ammo_max: "0",
					priweap_critchance: "0",
					priweap_mobility: "0",
					priweap_aim: "0",
					priweap_effects: "Used to stun enemies; 92%/84%/68%/36% vs 1/2/3/4+ Health",
					mobility: parseInt(values.base_mobility) + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			default:
				console.log("**XCOM** weapon invalid");
				setAttrs({
					priweap_dmg: "",
					priweap_critdmg: "",
					priweap_ammo: "",
					priweap_ammo_max: "",
					priweap_critchance: "",
					priweap_mobility: "",
					priweap_aim: "",
					priweap_effects: "",
					mobility: parseInt(values.base_mobility) + parseInt(values.secweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
		}
	});
});

on("change:secweap", function() {
	getAttrs(["secweap", "priweap_mobility", "base_mobility", "armor_mobility"], function(values) {
		console.log("**XCOM** secweap = " + values.secweap);
		switch(values.secweap) {
			case "CombatKnife":
				setAttrs({
					secweap_dmg: "1+1d3",
					secweap_critdmg: "3",
					secweap_ammo: "Inf",
					secweap_ammo_max: "Inf",
					secweap_critchance: "20",
					secweap_mobility: "0",
					secweap_aim: "20",
					secweap_effects: "None",
					mobility: parseInt(values.base_mobility) + parseInt(values.priweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "Pistol":
				setAttrs({
					secweap_dmg: "1d3",
					secweap_critdmg: "2",
					secweap_ammo: "Inf",
					secweap_ammo_max: "Inf",
					secweap_critchance: "0",
					secweap_mobility: "0",
					secweap_aim: "0",
					secweap_effects: "Aim -5 per tile past 9",
					mobility: parseInt(values.base_mobility) + parseInt(values.priweap_mobility) + parseInt(values.armor_mobility),,
				});
				break;
			case "SawedOffShotgun":
				setAttrs({
					secweap_dmg: "4+1d6",
					secweap_critdmg: "4",
					secweap_ammo: "1",
					secweap_ammo_max: "1",
					secweap_critchance: "16",
					secweap_mobility: "-1",
					secweap_aim: "20",
					secweap_effects: "Max range: 2 tiles; Target Armor +50%; No reloads",
					mobility: parseInt(values.base_mobility) -1 + parseInt(values.priweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "Sword":
				setAttrs({
					secweap_dmg: "2+1d3",
					secweap_critdmg: "3",
					secweap_ammo: "Inf",
					secweap_ammo_max: "Inf",
					secweap_critchance: "10",
					secweap_mobility: "0",
					secweap_aim: "20",
					secweap_effects: "None",
					mobility: parseInt(values.base_mobility) + parseInt(values.priweap_mobility) + parseInt(values.armor_mobility),,
				});
				break;
			case "RocketLauncher":
				setAttrs({
					secweap_dmg: "4+1d6",
					secweap_critdmg: "0",
					secweap_ammo: "2",
					secweap_ammo_max: "2",
					secweap_critchance: "0",
					secweap_mobility: "-1",
					secweap_aim: "0",
					secweap_effects: "Radius 3; Aim -30 if 2nd action",
					mobility: parseInt(values.base_mobility) -1 + parseInt(values.priweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			case "Holotargeter":
				setAttrs({
					secweap_dmg: "0",
					secweap_critdmg: "0",
					secweap_ammo: "Inf",
					secweap_ammo_max: "Inf",
					secweap_critchance: "0",
					secweap_mobility: "0",
					secweap_aim: "0",
					secweap_effects: "Aim +10 v Target; ends turn",
					mobility: parseInt(values.base_mobility) + parseInt(values.priweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
			default:
				console.log("**XCOM** weapon invalid");
				setAttrs({
					secweap_dmg: "",
					secweap_critdmg: "",
					secweap_ammo: "",
					secweap_ammo_max: "",
					secweap_critchance: "",
					secweap_mobility: "",
					secweap_aim: "",
					secweap_effects: "",
					mobility: parseInt(values.base_mobility) + parseInt(values.priweap_mobility) + parseInt(values.armor_mobility),
				});
				break;
		}
	});
});

on("change:armor_name", function() {
	getAttrs(["armor_name", "priweap_mobility", "base_mobility", "secweap_mobility", "base_health", "base_defense"], function(values) {
		console.log("**XCOM** armor_name = " + values.armor_name);
		switch(values.armor_name) {
			case "TacArmor":
				setAttrs({
					armor_mobility: "0",
					armor_hp: "2",
					armor_armor: "0",
					armor_defense: "0",
					armor_effects: "None",
					mobility: parseInt(values.base_mobility) + parseInt(values.priweap_mobility) + parseInt(values.secweap_mobility),
					hp: parseInt(values.base_health) + 2,
				});
				break;
			case "TacVest":
				setAttrs({
					armor_mobility: "2",
					armor_hp: "1",
					armor_armor: "0",
					armor_defense: "0",
					armor_effects: "None",
					mobility: parseInt(values.base_mobility) + 2 + parseInt(values.priweap_mobility) + parseInt(values.secweap_mobility),
					hp: parseInt(values.base_health) + 1,
				});
				break;
			case "LeatherJacket":
				setAttrs({
					armor_mobility: "4",
					armor_hp: "0",
					armor_armor: "0",
					armor_defense: "0",
					armor_effects: "None",
					mobility: parseInt(values.base_mobility) + 4 + parseInt(values.priweap_mobility) + parseInt(values.secweap_mobility),
					hp: parseInt(values.base_health)
				});
				break;
			default:
				console.log("**XCOM** armor invalid");
				setAttrs({
					armor_mobility: "0",
					armor_hp: "0",
					armor_armor: "0",
					armor_defense: "0",
					armor_effects: "None",
					mobility: parseInt(values.base_mobility) + parseInt(values.priweap_mobility) + parseInt(values.secweap_mobility),
				});
				break;
		}
	});
});

</script>
